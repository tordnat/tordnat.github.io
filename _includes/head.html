<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>
    {%- if page.title -%}
      {{ page.title }}
    {%- else -%}
      {{ site.title }}
    {%- endif -%}
  </title>

  {%-seo title=false-%}
  {%-feed_meta-%}

  <link rel="shortcut icon" type="image/x-icon" href="{{ site.favicon | relative_url }}" />
  <link rel="stylesheet" href="{{ "/assets/css/main.css" | relative_url }}" />

  <script>
    MathJax = {
      tex: {
        // IMPORTANT: For best compatibility with Kramdown, prefer \(...\) for inline and \\[...\\] for display.
        // Single dollar signs $...$ for inline can sometimes conflict with Markdown's italics/bold.
        // Double dollar signs $$...$$ for display generally work well with Kramdown if on their own line.
        inlineMath: [['$', '$'], ['\\(', '\\)']], // Keep $ for convenience, but use \( for reliability
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true, // Allows escaping dollar signs with \$
        tags: 'ams', // Enables AMS equation numbering and features
        packages: {'[+]': ['ams']} // Explicitly load AMS package for commands like \infty, \mathbb
      },
      chtml: {
        fontCache: 'global' // Caches fonts for performance
      },
      loader: {
        load: ['[tex]/ams'] // Ensure AMS package is loaded
      },
      options: {
        // Prevents MathJax from processing code blocks, which often contain $ or other math-like characters.
        // These are common classes Jekyll's Rouge highlighter adds to code.
        ignoreHtmlClass: 'highlight|language-|rouge-highlight|rouge-code|mermaid' // Added 'mermaid' as a common block to ignore
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>